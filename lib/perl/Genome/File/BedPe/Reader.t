#!/usr/bin/env perl

use above 'Genome';
use Test::More;
use IO::String;

use strict;
use warnings;

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

my $pkg = "Genome::File::BedPe::Reader";

use_ok($pkg);

my $bpe_str = join("\n",
    join("\t", 1..16),
    join("\t", 17..32)
    );

subtest "peek" => sub {
    my $bpe_fh = new IO::String($bpe_str);
    my $reader = $pkg->fhopen($bpe_fh, "Test File");

    # Peek!
    my $entry_peek = $reader->peek;
    ok($entry_peek, 'Peeked at first entry');

    my @standard_field_order = qw(
        chrom1 start1 end1
        chrom2 start2 end2
        name score strand1 strand2
        );

    for my $i (0..$#standard_field_order) {
        my $f = $standard_field_order[$i];
        is($entry_peek->{fields}{$f}, $i + 1, "Entry 1, field $f");
    }
};

done_testing();
