#!/usr/bin/env genome-perl

use strict;
use warnings FATAL => 'all';

use Test::More;
use Test::Deep;
use above 'Genome';
use Genome::Utility::Test qw(compare_ok);
use Test::Exception;
use Test::Output;
use Genome::VariantReporting::Framework::Plan::TestHelpers; # defines classes

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
};

my $pkg = 'Genome::VariantReporting::Framework::Plan::MasterPlan';
use_ok($pkg) || die;

my $plan = $pkg->create_from_file(plan_file('test.yaml'));
my @expected = qw(e1_provided1 e1_provided2 e2_provided1 e2_provided2);
cmp_bag([$plan->resources_required], \@expected, 'Found expected resources_required');

done_testing();


sub plan_file {
    my $filename = shift;
    return File::Spec->join(__FILE__ . ".d", $filename);
}
