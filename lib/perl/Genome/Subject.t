#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
};

use strict;
use warnings;

use above 'Genome';

use Test::More;

use_ok('Genome::Subject') or die;
class Genome::SubjectTest { # class for testing b/c subject is abstract
    is => 'Genome::Subject',
};

# Basic create
my $subject = Genome::SubjectTest->create(name => '__TEST_SUBJECT1__');
ok($subject, 'create subject');
ok(!$subject->nomenclature, 'no nomenclature');

# Create w/ other stuff
my $project = Genome::Project->create(name => '__TEST_PROJECT__');
ok($project, 'create project');
$subject = Genome::SubjectTest->create(
    name => '__TEST_SUBJECT2__',
    nomenclature => 'TGI',
    projects => [ $project ],
    attribute1 => 'value1',
);
ok($subject, 'create subject');
is_deeply([$subject->projects], [$project], 'subject has projects');
is($subject->nomenclature, 'TGI', 'nomenclature');
my $attribute1 = $subject->attributes(attribute_label => 'attribute1');
ok($attribute1, 'attribute1');
is($attribute1->attribute_value, 'value1', 'attribute1 value');
is($attribute1->nomenclature, 'TGI', 'attribute1 nomenclature');

done_testing();
