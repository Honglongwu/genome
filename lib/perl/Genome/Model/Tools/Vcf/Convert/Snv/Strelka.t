#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
};

use strict;
use warnings;

use above "Genome";

use Test::More;

use_ok('Genome::Model::Tools::Vcf::Convert::Snv::Strelka') or die;

my $expected_vcf_header = __FILE__ . '.d/expected_vcf_header';
my $input_vcf = __FILE__ . '.d/input.clean.vcf';
my $input_fh = Genome::Sys->open_file_for_reading($input_vcf);
my ($output_fh, $output_vcf_header) = Genome::Sys->create_temp_file();
my $public_reference = 'TEST_PUBLIC_REFERENCE';
my @header_columns =
        qw(TEST_COLUMN_HEADING_1 TEST_COLUMN_HEADING_2 TEST_COLUMN_HEADING_3);
Genome::Model::Tools::Vcf::Convert::Snv::Strelka::_print_header(
        $public_reference, $input_fh, $output_fh, \@header_columns);
map {$_->close()} ($input_fh, $output_fh);

my $diff = Genome::Sys->diff_file_vs_file($output_vcf_header,
        $expected_vcf_header);
ok(!$diff, 'output header matched expected vcf header')
    or diag("diff results:\n$diff");

done_testing();

1;
